% Language
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage[english]{babel}
\babelhyphenation[english]{feed-back-pro-ces-ser}

% Page Formatting
\usepackage[a4paper, width=150mm, top=25mm, bottom=25mm, includefoot]{geometry}

% Line Height
\usepackage{setspace}
\linespread{1.3}

% Paragraph Indentation
\setlength{\parindent}{0pt}

% Header
\usepackage{fancyhdr}
\pagestyle{fancy}
\lhead{}
\chead{}
\makeatletter
\rhead{\slshape{\nouppercase{\rightmark}}}
\makeatother

% Multi-column TOC
\usepackage{tocbibind}
\usepackage[toc]{multitoc}

% Array
\usepackage{array}
\usepackage{textpos}

% Chapter/section title formatting
\usepackage{titlesec}
%\titleformat{\chapter}[display] {\normalfont\Huge\bfseries}{\chaptertitlename\ \thechapter}{0pt}{\Huge}
%\titleformat{\chapter}[hang]{\Huge\bfseries}{\thechapter\hspace{12pt}\textcolor{gainsboro}{|}\hspace{12pt}}{0pt}{\Huge\bfseries}
\titleformat{\chapter}[display]{\normalfont\Large\bfseries}{\chaptertitlename\ \thechapter}{-10pt}{\Huge}[\vspace{8pt}\titlerule]
\titlespacing{\chapter}{0cm}{0cm}{0.5cm}

% Footnote
\usepackage[bottom]{footmisc}
\emergencystretch=1em
\usepackage{scrextend}
\addtokomafont{labelinglabel}{\textnormal}
\usepackage{pdfpages}
\usepackage{needspace}

% Math & Symbols
\usepackage{float}
\usepackage{amsmath}
\usepackage[binary-units=true]{siunitx}
\usepackage{esvect}
\usepackage{verbatim}

% Equation spacing
\AtBeginDocument{%
 \abovedisplayskip=6pt plus 2pt minus 2pt
 \abovedisplayshortskip=6pt plus 2pt minus 2pt
 \belowdisplayskip=6pt plus 2pt minus 2pt
 \belowdisplayshortskip=6pt plus 2pt minus 2pt
}

% Text highlight
\usepackage{soul}

% Enumeration & Tables
\usepackage{enumerate}
\usepackage{enumitem}
\usepackage{multirow} 
\usepackage{multicol}
\usepackage{ltablex}
\usepackage{spreadtab}
\usepackage{booktabs}
\usepackage{tabto}

% Custom tables commands for fixed-column sizes
\newcommand{\PreserveBackslash}[1]{\let\temp=\\#1\let\\=\temp}
\newcolumntype{C}[1]{>{\PreserveBackslash\centering}p{#1}}
\newcolumntype{R}[1]{>{\PreserveBackslash\raggedleft}p{#1}}
\newcolumntype{L}[1]{>{\PreserveBackslash\raggedright}p{#1}}

% Tikz
\usepackage{tikz}
\usetikzlibrary{automata,positioning}

% Enumeration Formatting
\newcommand{\tabitem}{~~\llap{\textbullet}~~}
\newcommand{\sqrbulletsml}{\textcolor{black}{\raisebox{.45ex}{\rule{.6ex}{.6ex}}}}
\newcommand{\sqrbulletmed}{\textcolor{black}{\raisebox{.40ex}{\rule{.7ex}{.7ex}}}}

\renewcommand{\labelitemi}{\sqrbulletmed}
\renewcommand{\labelitemii}{\sqrbulletsml}
\renewcommand{\labelitemiii}{\sqrbulletsml}
\renewcommand{\labelitemiv}{\sqrbulletsml}

% Colors
\usepackage{xcolor}

% Color Definitions (latexcolor.com)
\definecolor{cerulean}{rgb}{0.0, 0.48, 0.65}
\definecolor{earthyellow}{rgb}{0.88, 0.66, 0.37}
\definecolor{darkmagenta}{rgb}{0.55, 0.0, 0.55}
\definecolor{darkolivegreen}{rgb}{0.33, 0.42, 0.18}
\definecolor{codegray}{gray}{0.9}
\definecolor{gainsboro}{rgb}{0.86, 0.86, 0.86}

% Code
\usepackage{algorithm}
\usepackage[noend]{algpseudocode}
\usepackage{listings}
\renewcommand{\arraystretch}{1.2}
\renewcommand{\tabcolsep}{0.2cm}

% Custom inline-code command
%\newcommand{\lstinln}[1]{\colorbox{gainsboro}{\texttt{#1}}}
\newcommand{\code}[1]{%
  \begingroup\setlength{\fboxsep}{2pt}%
  \colorbox{gainsboro}{\texttt{\hspace{2pt}\vphantom{Ay}#1\hspace{2pt}}}%
  \endgroup
}

% Code Snippet Formatting
\lstset{
    backgroundcolor=\color{black!5},        % set backgroundcolor
    basicstyle=\footnotesize\ttfamily,      % basic font setting
    frame=single,                           % draw a frame at the top and bottom of the code block
    framesep=5pt,                           % frame margin
    xleftmargin=5pt,                        % frame margin
    xrightmargin=5pt,                       % frame margin
    tabsize=4,                              % tab space width
    showstringspaces=false,                 % don't mark spaces in strings
    breaklines=true,                        % wrap lines
    commentstyle=\color{darkolivegreen},    % comment color
    keywordstyle=\color{darkmagenta},       % keyword color
    stringstyle=\color{earthyellow},        % string color
    identifierstyle=\color{cerulean}
}

% Continuous Number (1, 2, 3 ..)
\usepackage{chngcntr}
\counterwithout{figure}{chapter}
\counterwithout{table}{chapter}
\counterwithout{equation}{chapter}

% Graphics & Figures
\usepackage{graphicx}
%\usepackage{subfig}
%\usepackage{float}
\usepackage{caption}
\usepackage{subcaption}
\usepackage{pgfplots}
\usepackage{tikz}
\usepackage{circuitikz}
\usetikzlibrary{shapes,arrows}
\pgfplotsset{compat=1.15}

\usetikzlibrary{shapes,arrows}
\tikzstyle{decision} = [diamond, draw, fill=blue!20, 
    text width=4.5em, text badly centered, node distance=3cm, inner sep=0pt]
\tikzstyle{block} = [rectangle, draw, fill=blue!20, 
    text width=5em, text centered, rounded corners, minimum height=4em]
\tikzstyle{line} = [draw, -latex']
\tikzstyle{cloud} = [draw, ellipse,fill=red!20, node distance=3cm,
    minimum height=2em, text badly centered, text width=4.5em]
    
% Appendix
\usepackage[toc]{appendix}

% Bibliography & Citation
\usepackage[style=numeric]{biblatex}
\usepackage{csquotes}
\usepackage{hyperref}
\DeclareNameAlias{sortname}{last-first}
\DeclareNameAlias{default}{last-first}
\addbibresource{resources.bib}
%\let\cite=\supercite

\DeclareCiteCommand{\supercite}[\mkbibsuperscript]
  {\usebibmacro{prenote}}
  {\usebibmacro{citeindex}%
   \bibopenbracket\usebibmacro{cite}}
  {\supercitedelim}
  {\usebibmacro{postnote}\bibclosebracket}

% Section cross-referencing
\usepackage{nameref}

% Glossaries & Nomenclature
\usepackage[acronym, nogroupskip]{glossaries}
\usepackage[intoc]{nomencl}
\renewcommand*\nompreamble{\begin{multicols}{2}}
\renewcommand*\nompostamble{\end{multicols}}
\makeglossaries
\makenomenclature
\setglossarysection{section}
\input{glossary.tex}